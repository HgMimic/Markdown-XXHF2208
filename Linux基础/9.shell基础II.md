# Bash 变量

## 定义变量

shell 中定义变量的格式为 `name=[value]`

- 变量默认为字符串类型，如果没有指定值，变量将被赋值为空字符串。
- 若值包含空格，需要使用双引号或单引号包含。
- 变量的命名规则：字母数字下划线，不能以数字开头。
- 命令的结果赋予变量，可使用`$()` 或 ` `` ` 来包含命令。
- 计算的值赋予变量，可使用 `$(())` 包含。
- 赋值的 `=` 前后不能有空格。

## 调用变量

shell 中调用变量的格式为 `${name}`

- 变量需要使用 `$` 来调用。
- 变量可以叠加，如： `C=${A}${B}` ,以字符串形式拼接。
- 为了一个变量名更加清楚，避免混淆，尽量使用 `${}` 形式调用。

```bash
#!/bin/bash
A_1=123456 #变量的命名和定义
_A1=123456 #下划线开头也没问题
A_1_A1=${A_1}${_A1} #字符串拼接
A_2=$(ls /root/) #将命令的输出赋予变量
A_3=`ls /root/` #将命令的输出赋予变量，这种形式建议少用，和单引号易混淆
A_4=$(( 1 + 2 - 3 * 4 / 5 )) #算式在$(())里面写
A_5=$(( ${A_1} - ${_A1} )) #里面可以调用变量
MUL=-
A_6=$(( ${A_1} ${MUL} ${_A1} )) #运算符也可以是一个变量
echo "the number is ${A_1}7890" #调用变量的好习惯，加上${}，避免混淆
unset A_1 #释放掉此变量，释放内存空间
```

## 变量分类

- 用户自定义变量：这种变量由用户自定义命名与值，最常见的变量。
- 环境变量：
  - 在 bash 中预设了很多环境变量，在工作中可以直接调用这些变量。
  - 系统预先设定好了一些对系统起作用的环境变量，比如`ID` 、 `HOME` 、 `OLPWD` 、 `PATH` 。
  - 用户也可以自定义环境变量，使用 `export A=1` 声明自定义环境变量且赋值。
- 位置参数变量：bash 中定义好的变量，变量名不能自定义，变量作用是固定的。
  - `$0` 当前执行的程序或脚本名。
  - `$n` 当前脚本的第 n 个参数的值。
  - `${10}` 第十个参数开始要加大括号。
- 预定义变量：bash 中定义好的变量，变量名不能自定义，变量作用是固定的。
  - `$#` 当前脚本的参数个数。
  - `$*` 当前脚本的所有参数，多个参数用空格分开，看成一个整体。
  - `$@` 当前脚本的所有参数，每个参数看成一个独立的值（即用`""`分隔）。
  - `$?` 上条命令执行的返回值，`0`表示执行正常，其他值表示异常或错误。
  - `$!` 当前终端后台运行的最后一个进程号（无论该进程是否还在运行，记录都保持）。
  - `$$` 当前所在进程的进程号。

## `read` 命令：从标准输入读取内容赋值给变量

`read [选项] [变量名*n]` 展开键盘交互输入，将输入内容赋值给变量。

> `-p <提示信息>` 等待输入时，输出提示信息。  
> `-t <秒数>` 等待输入的超时时间。  
> `-n <字符数>` 仅接受指定数量的字符就自动结束输入，自动结束因为没有输入回车所以后续输出会从当前行开始。  
> `-s` 隐藏输入内容，读取不受影响。

- 如果 read 后不接变量，则读到的值默认赋给 `REPLY` 这个变量。
- 如果 read 后接多个变量，则读到的值，用空格分开，按顺序分别赋给每个变量，最后一个变量会被赋予剩余全部字符。

`read 变量名 < 文件` 将文件内容输入重定向赋给变量

```bash
#!/bin/bash
read -t 30 -p "please input your name:" name
echo "Welcome! Dear ${name}!"
```
